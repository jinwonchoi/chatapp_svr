(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a3bc2ee"],{5791:function(t,e,s){"use strict";var a=s("7cad"),i=s.n(a);i.a},"7cad":function(t,e,s){},c8ee:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"border border-solid d-theme-border-grey-light rounded relative overflow-hidden",attrs:{id:"chat-app"}},[s("vs-sidebar",{staticClass:"items-no-padding",attrs:{parent:"#chat-app","click-not-close":t.clickNotClose,"hidden-background":t.clickNotClose,id:"chat-list-sidebar"},model:{value:t.isChatSidebarActive,callback:function(e){t.isChatSidebarActive=e},expression:"isChatSidebarActive"}},[s("div",{staticClass:"chat__profile-search flex p-4"},[s("vs-input",{staticClass:"w-full mx-5 input-rounded-full",attrs:{"icon-no-border":"",icon:"icon-search","icon-pack":"feather",placeholder:"Search or start a new chat"},model:{value:t.searchQuery,callback:function(e){t.searchQuery=e},expression:"searchQuery"}}),s("feather-icon",{staticClass:"md:inline-flex lg:hidden -ml-3 cursor-pointer",attrs:{icon:"XIcon"},on:{click:function(e){return t.toggleChatSidebar(!1)}}})],1),s("vs-divider",{staticClass:"d-theme-border-grey-light m-0"}),s(t.scrollbarTag,{key:t.$vs.rtl,tag:"component",staticClass:"chat-scroll-area pt-4",attrs:{settings:t.settings}},[s("div",{staticClass:"chat__chats-list mb-8"},[s("h3",{staticClass:"text-primary mb-5 px-4"},[t._v("Chats")]),s("ul",{staticClass:"chat__active-chats bordered-items"},t._l(t.chatSessions,(function(e,a){return s("li",{key:a,staticClass:"cursor-pointer",on:{click:function(s){return t.updateActiveChatSession(e.id)}}},[s("chat-session",{attrs:{showLastMsg:"",chatSession:e,lastMessaged:e.updatedDtm,lastMessage:e.lastMessage,isActiveChatSession:t.isActiveChatSession(e.id)}})],1)})),0)])])],1),s("div",{staticClass:"chat__bg no-scroll-content chat-content-area border border-solid d-theme-border-grey-light border-t-0 border-r-0 border-b-0",class:{"sidebar-spacer--wide":t.clickNotClose,"flex items-center justify-center":null===t.activeChatSession}},[t.activeChatSession?[s("div",{staticClass:"chat__navbar"},[s("chat-navbar",{attrs:{isSidebarCollapsed:!t.clickNotClose,chatSessionId:t.activeChatSession.id,isPinnedProp:t.isChatPinned},on:{openContactsSidebar:function(e){return t.toggleChatSidebar(!0)},showProfileSidebar:t.showProfileSidebar,toggleIsChatPinned:t.toggleIsChatPinned}})],1),s(t.scrollbarTag,{key:t.$vs.rtl,ref:"chatLogPS",tag:"component",staticClass:"chat-content-scroll-area border border-solid d-theme-border-grey-light",attrs:{settings:t.settings}},[s("div",{ref:"chatLog",staticClass:"chat__log"},[t.activeChatSession?s("chat-log",{attrs:{chatSession:t.activeChatSession}}):t._e()],1)]),t.hasChatConsultDetails&&t.activeChatSession.agentId===t.activeUser.agentId?s("div",{staticClass:"chat__input flex p-4 bg-white"},[s("vs-input",{staticClass:"flex-1",attrs:{placeholder:"Type Your Message"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMsg(e)}},model:{value:t.typedMessage,callback:function(e){t.typedMessage=e},expression:"typedMessage"}}),s("vs-button",{staticClass:"bg-primary-gradient ml-4",attrs:{type:"filled"},on:{click:t.sendMsg}},[t._v("Send")])],1):t.hasChatConsultDetails&&t.activeChatSession.agentId!==t.activeUser.agentId?s("div",{staticClass:"chat__input flex p-4"}):s("div",{staticClass:"chat__input flex p-4 bg-white"},[s("vs-button",{staticClass:"bg-primary-gradient ml-4",attrs:{type:"filled"},on:{click:t.takeChatSession}},[t._v("Pick this chat")])],1)]:void 0],2)],1)},i=[],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chat__contact flex items-center px-2 pt-4 pb-2",class:{"bg-primary-gradient text-white shadow-lg":t.isActiveChatUser}},[s("div",{staticClass:"contact__avatar mr-1"},[s("vs-avatar",{staticClass:"border-2 border-solid border-white",attrs:{src:t.contact.photoURL,size:"42px"}})],1),s("div",{staticClass:"contact__container w-full flex items-center justify-between overflow-hidden"},[s("div",{staticClass:"contact__info flex flex-col truncate w-5/6"},[s("h5",{staticClass:"font-semibold",class:{"text-white":t.isActiveChatUser}},[t._v(t._s(t.contact.displayName))]),s("span",{staticClass:"truncate"},[t._v(t._s(t.showLastMsg?t.$store.getters["chat/chatLastMessaged"](t.contact.uid).textContent:t.contact.about))])]),s("div",{staticClass:"chat__contact__meta flex self-start flex-col items-end w-1/6"},[s("span",{staticClass:"whitespace-no-wrap"},[t._v(t._s(t._f("date")(t.lastMessaged)))]),t.unseenMsg?s("vs-chip",{staticClass:"number",attrs:{color:"primary"}},[t._v(t._s(t.unseenMsg))]):t._e()],1)])])},o=[],n=(s("c5f6"),{props:{contact:{type:Object,required:!0},isActiveChatUser:{type:Boolean},lastMessaged:{type:String,default:""},showLastMsg:{type:Boolean,default:!1},unseenMsg:{type:Number,default:0}}}),c=n,l=s("2877"),h=Object(l["a"])(c,r,o,!1,null,null,null),d=h.exports,u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.chatData?s("div",{staticClass:"m-8",attrs:{id:"component-chat-log"}},t._l(t.chatData.msg,(function(e,a){return s("div",{key:a,staticClass:"msg-grp-container"},[t.chatData.msg[a-1]?[t.isSameDay(e.createdDtm,t.chatData.msg[a-1].createdDtm)?t._e():s("vs-divider",{staticClass:"msg-time"},[s("span",[t._v(t._s(t.toDate(e.createdDtm)))])]),t.hasSentPreviousMsg(t.chatData.msg[a-1].inbound,e.inbound)?t._e():s("div",{staticClass:"spacer mt-8"})]:t._e(),s("div",{staticClass:"flex items-start",class:[{"flex-row-reverse":!e.inbound}]},[t.chatData.msg[a-1]?[t.hasSentPreviousMsg(t.chatData.msg[a-1].inbound,e.inbound)&&t.isSameDay(e.createdDtm,t.chatData.msg[a-1].createdDtm)?t._e():[s("vs-avatar",{staticClass:"border-2 shadow border-solid border-white m-0 flex-shrink-0",class:e.inbound?"sm:ml-5 ml-3":"sm:mr-5 mr-3",attrs:{size:"40px",src:t.senderImg(e.inbound)}})]]:t._e(),0==a?[s("vs-avatar",{staticClass:"border-2 shadow border-solid border-white m-0 flex-shrink-0",class:e.inbound?"sm:ml-5 ml-3":"sm:mr-5 mr-3",attrs:{size:"40px",src:t.senderImg(e.inbound)}})]:t._e(),t.chatData.msg[a-1]?[t.hasSentPreviousMsg(t.chatData.msg[a-1].inbound,e.inbound)&&t.isSameDay(e.createdDtm,t.chatData.msg[a-1].createdDtm)?s("div",{staticClass:"mr-16"}):t._e()]:t._e(),s("div",{staticClass:"msg break-words relative shadow-md rounded py-3 px-4 mb-2 rounded-lg max-w-sm",class:{"bg-primary-gradient text-white":e.inbound,"border border-solid border-transparent bg-white":!e.inbound}},[s("span",[t._v(t._s(e.message))])])],2)],2)})),0):t._e()},g=[],v={props:{chatSession:{type:Object,required:!0}},computed:{chatData:function(){if(this.chatSession["chatConsultDetails"]){var t=this.$store.getters["chat/chatMessagesOfChatId"](this.chatSession.chatConsultDetails.id);return console.log(t),this.$store.getters["chat/chatMessagesOfChatId"](this.chatSession.chatConsultDetails.id)}return{msg:this.$store.getters["chat/waitingMessages"]}},activeUserImg:function(){var t="http://192.168.0.104:8090/issuetool";return t+this.$store.state.AppActiveUser.profileUrl},senderImg:function(){var t=this,e="http://192.168.0.104:8090/issuetool";return function(s){return s?e+"/files/profile/default.jpg":t.chatSession["agentInfo"]?e+t.chatSession.agentInfo.profileUrl:void 0}},hasSentPreviousMsg:function(){return function(t,e){return t===e}}},methods:{isSameDay:function(t,e){var s=new Date(Date.parse(t)),a=new Date(Date.parse(e));return s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()&&s.getDate()===a.getDate()},toDate:function(t){var e="en-us",s=new Date(Date.parse(t)),a=s.toLocaleString(e,{month:"short"});return"".concat(s.getDate()," ").concat(a)},scrollToBottom:function(){var t=this;this.$nextTick((function(){t.$parent.$el.scrollTop=t.$parent.$el.scrollHeight}))}},updated:function(){this.scrollToBottom()},mounted:function(){this.scrollToBottom()}},p=v,f=Object(l["a"])(p,u,g,!1,null,null,null),b=f.exports,m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!=t.userDetails?s("div",{staticClass:"chat__header"},[s("vs-navbar",{staticClass:"p-4 flex navbar-custom",attrs:{color:"white",type:"flat"}},[s("div",{staticClass:"relative flex mr-4"},[t.isSidebarCollapsed?s("feather-icon",{staticClass:"mr-4 cursor-pointer",attrs:{icon:"MenuIcon"},on:{click:function(e){return e.stopPropagation(),t.$emit("openContactsSidebar")}}}):t._e(),s("vs-avatar",{staticClass:"m-0 border-2 border-solid border-white",attrs:{size:"40px",src:t.userImg(t.userDetails.profileUrl)},on:{click:function(e){return e.stopPropagation(),t.$emit("showProfileSidebar",t.userDetails.id)}}}),s("div",{staticClass:"h-3 w-3 border-white border border-solid rounded-full absolute right-0 bottom-0",class:"bg-"+t.getStatusColor(!1)})],1),s("h6",[t._v(t._s(t.userDetails.userName)+" with "+t._s(t.customer.customerId))]),s("vs-spacer")],1)],1):s("div",{staticClass:"chat__header"},[s("vs-navbar",{staticClass:"p-4 flex navbar-custom",attrs:{color:"white",type:"flat"}},[s("div",{staticClass:"relative flex mr-4"},[t.isSidebarCollapsed?s("feather-icon",{staticClass:"mr-4 cursor-pointer",attrs:{icon:"MenuIcon"},on:{click:function(e){return e.stopPropagation(),t.$emit("openContactsSidebar")}}}):t._e(),s("vs-avatar",{staticClass:"m-0 border-2 border-solid border-white",attrs:{size:"40px",src:t.userImg(this.$store.state.AppActiveUser.photoUrl)}}),s("div",{staticClass:"h-3 w-3 border-white border border-solid rounded-full absolute right-0 bottom-0",class:"bg-"+t.getStatusColor(!1)})],1),s("h6",[t._v(t._s(t.customer.customerId))]),s("vs-spacer")],1)],1)},C=[],S={props:{chatSessionId:{type:Number,required:!0},isPinnedProp:{type:Boolean,required:!0},isSidebarCollapsed:{type:Boolean,required:!0}},computed:{isPinnedLocal:{get:function(){return this.isPinnedProp},set:function(t){this.$emit("toggleIsChatPinned",t)}},userImg:function(){var t="http://192.168.0.104:8090/issuetool";return function(e){return t+e}},userDetails:function(){return this.$store.getters["chat/chatSession"](this.chatSessionId).agentInfo},customer:function(){return this.$store.getters["chat/chatSession"](this.chatSessionId).customerInfo},getStatusColor:function(){var t=this;return function(e){var s=t.getUserStatus(e);return"online"===s?"success":"do not disturb"===s?"danger":"away"===s?"warning":"grey"}}},methods:{getUserStatus:function(t){return!!t}}},_=S,w=Object(l["a"])(_,m,C,!1,null,null,null),y=w.exports,x=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"parentx-demo-2"}},[s("vs-sidebar",{staticClass:"items-no-padding",attrs:{parent:"#chat-app","position-right":!t.isLoggedInUser,"hidden-background":!1,id:"chat-profile-sidebar"},model:{value:t.activeLocal,callback:function(e){t.activeLocal=e},expression:"activeLocal"}},[s("div",{staticClass:"header-sidebar relative flex flex-col p-0",attrs:{slot:"header"},slot:"header"},[s("feather-icon",{attrs:{icon:"XIcon",svgClasses:"m-2 cursor-pointer absolute top-0 right-0"},on:{click:function(e){return t.$emit("closeProfileSidebar",!1)}}}),s("div",{staticClass:"relative inline-flex mx-auto mb-5 mt-6"},[s("vs-avatar",{staticClass:"m-0 border-white border-2 border-solid shadow-md",attrs:{src:t.chatUser.photoURL,size:"70px"}}),s("div",{staticClass:"h-5 w-5 border-white border-2 border-solid rounded-full absolute right-0 bottom-0",class:"bg-"+t.statusColor})],1),s("h4",{staticClass:"mr-2 self-center"},[t._v(t._s(t.chatUser.displayName))])],1),s(t.scrollbarTag,{key:t.$vs.rtl,tag:"component",staticClass:"scroll-area",attrs:{settings:t.settings}},[s("div",{staticClass:"p-8"},[s("h6",{staticClass:"mb-2",class:{"ml-4":t.isLoggedInUser}},[t._v("About")]),t.isLoggedInUser?s("vs-textarea",{staticClass:"mb-10",attrs:{counter:"120",maxlength:"120","counter-danger":t.counterDanger,rows:"5"},on:{"update:counterDanger":function(e){t.counterDanger=e},"update:counter-danger":function(e){t.counterDanger=e}},model:{value:t.about,callback:function(e){t.about=e},expression:"about"}}):s("p",[t._v(t._s(t.chatUser.about))]),t.isLoggedInUser?s("div",{staticClass:"userProfile__status"},[s("h6",{staticClass:"mb-4"},[t._v("Status")]),s("ul",[s("li",{staticClass:"mb-2"},[s("vs-radio",{attrs:{"vs-value":"online",color:"success"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[t._v("Active")])],1),s("li",{staticClass:"mb-2"},[s("vs-radio",{attrs:{"vs-value":"do not disturb",color:"danger"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[t._v("Do Not Disturb")])],1),s("li",{staticClass:"mb-2"},[s("vs-radio",{attrs:{"vs-value":"away",color:"warning"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[t._v("Away")])],1),s("li",{staticClass:"mb-2"},[s("vs-radio",{attrs:{"vs-value":"offline",color:"grey"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[t._v("Offline")])],1)])]):t._e()],1)])],1)],1)},D=[],$=s("9d63"),k=s.n($),I={props:{userId:{type:Number,required:!0},active:{type:Boolean,required:!0},isLoggedInUser:{type:Boolean,required:!0}},data:function(){return{counterDanger:!1,settings:{maxScrollbarLength:60,wheelSpeed:.6}}},computed:{chatUser:function(){return this.$store.getters["chat/chatUser"](this.userId)},activeLocal:{get:function(){return this.active},set:function(t){this.$emit("closeProfileSidebar",t)}},about:{get:function(){return this.chatUser.about},set:function(t){this.$store.dispatch("updateUserInfo",{about:t})}},status:{get:function(){return this.chatUser.status},set:function(t){this.$store.dispatch("updateUserInfo",{status:t})}},statusColor:function(){var t=this.chatUser.status;return"online"===t?"success":"do not disturb"===t?"danger":"away"===t?"warning":"grey"},scrollbarTag:function(){return this.$store.getters.scrollbarTag}},components:{VuePerfectScrollbar:k.a}},P=I,M=Object(l["a"])(P,x,D,!1,null,null,null),U=M.exports,A=s("c598"),L={data:function(){return{active:!0,isHidden:!1,searchContact:"",activeProfileSidebar:!1,activeChatSession:null,userProfileId:-1,typedMessage:"",isChatPinned:!1,settings:{maxScrollbarLength:60,wheelSpeed:.7},clickNotClose:!0,isChatSidebarActive:!0,isLoggedInUserProfileView:!1}},watch:{windowWidth:function(){this.setSidebarWidth()}},computed:{activeUser:function(){return this.$store.state.AppActiveUser},getStatusColor:function(){var t=this;return function(e){var s=t.getUserStatus(e);return"online"===s?"success":"do not disturb"===s?"danger":"away"===s?"warning":"grey"}},searchQuery:{get:function(){return this.$store.state.chat.chatSearchQuery},set:function(t){this.$store.dispatch("chat/setChatSearchQuery",t)}},scrollbarTag:function(){return this.$store.getters.scrollbarTag},isActiveChatSession:function(){var t=this;return function(e){return t.activeChatSession&&e===t.activeChatSession.id}},hasChatConsultDetails:function(){return this.activeChatSession["chatConsultDetails"]},windowWidth:function(){return this.$store.state.windowWidth},chatSessions:function(){return this.$store.state.chat.chatSessions}},methods:{getUserStatus:function(t){return t?this.$store.state.AppActiveUser.status:this.contacts[this.activeChatSession].status},closeProfileSidebar:function(t){this.activeProfileSidebar=t},updateActiveChatSession:function(t){this.activeChatSession=this.$store.getters["chat/chatSession"](t);var e=this.activeChatSession["chatConsultDetails"]?this.activeChatSession.chatConsultDetails.id:null;e?(this.$store.dispatch("chat/getMessagesByChatConsultDetails",{chatId:e}),this.$store.dispatch("chat/setMessagesAlreadyRead",{chatId:e})):this.$store.dispatch("chat/fetchWaitingMessageQueue",{chatSession:this.activeChatSession});var s=this.$store.getters["chat/chatMessagesOfChatId"](e);this.isChatPinned=!!s&&s.isPinned,this.toggleChatSidebar(),this.typedMessage=""},showProfileSidebar:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.userProfileId=t,this.isLoggedInUserProfileView=e,this.activeProfileSidebar=!this.activeProfileSidebar},sendMsg:function(){if(this.typedMessage){var t=this.activeChatSession["chatConsultDetails"]?this.activeChatSession.chatConsultDetails:null,e={msg:this.typedMessage,chatConsultDetails:t};this.$store.dispatch("chat/sendMessageToNexmo",e),this.typedMessage="";var s=this.$refs.chatLogPS.$el||this.$refs.chatLogPS;s.scrollTop=this.$refs.chatLog.scrollHeight}},takeChatSession:function(){this.$store.dispatch("chat/takeWaitingSessionForChat",{chatSession:this.activeChatSession,agentId:this.$store.state.AppActiveUser.agentId})},toggleIsChatPinned:function(t){this.isChatPinned=t},setSidebarWidth:function(){this.windowWidth<1200?this.isChatSidebarActive=this.clickNotClose=!1:this.isChatSidebarActive=this.clickNotClose=!0},toggleChatSidebar:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!t&&this.clickNotClose||(this.isChatSidebarActive=t)}},components:{VuePerfectScrollbar:k.a,ChatContact:d,UserProfile:U,ChatNavbar:y,ChatLog:b,ChatSession:A["a"]},created:function(){this.$store.dispatch("chat/fetchChatSessionStatus"),this.setSidebarWidth()},beforeDestroy:function(){this.$stomp.disconnect()},mounted:function(){this.$store.dispatch("chat/setChatSearchQuery",""),this.$stomp.connect()}},N=L,T=(s("5791"),Object(l["a"])(N,a,i,!1,null,null,null));e["default"]=T.exports}}]);
//# sourceMappingURL=chunk-7a3bc2ee.263dc88b.js.map